@using RestaurantSystem.Data.Models.Reservations
@model RestaurantDetailsViewModel

<h1>@Model.Name</h1>
<hr />

<div class="row">
    <div class="col-3">
        <div class="list-group" id="list-tab" role="tablist">
            <a class="list-group-item list-group-item-action active" id="list-home-list" data-toggle="list" href="#list-home" role="tab" aria-controls="home">Резервацй</a>
            <a class="list-group-item list-group-item-action" id="list-profile-list" data-toggle="list" href="#list-profile" role="tab" aria-controls="profile">Profile</a>
        </div>
    </div>
    <div class="col-8">
        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
                <div class="card mb-5">
                    <div class="card-header">(@Model.PendingReservationsCount) </div>
                    <div class="card-block p-0">
                        <table id="myTable" class="table table-bordered table-sm m-0 text-center">

                            <thead>
                                <tr>
                                    <th scope="col">Дата</th>
                                    <th scope="col">Име</th>
                                    <th scope="col">Телефон</th>
                                    <th scope="col">Гости</th>
                                    <th scope="col">Статус</th>
                                    <th scope="col"></th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var reservation in Model.Reservations)
                                {
                                    <tr id="myUL">
                                        <td>@reservation.Date.ToString("dd.MM.yy HH:mm")</td>
                                        <td>@reservation.FirstName</td>
                                        @{
                                            var number = $"+359{reservation.PhoneNumber}";
                                        }
                                        <td>@number</td>
                                        <td>@reservation.PeopleCount</td>
                                        <td>
                                            @if (reservation.ReservationStatus == "Approved")
                                            {
                                                <span style="font-size: 1em; color: Green;">
                                                    <i class="fas fa-circle"></i> Потвардена
                                                </span>
                                            }

                                            @if (reservation.ReservationStatus == "Canceled")
                                            {
                                                <span style="font-size: 1em; color: Tomato;">
                                                    <i class="fas fa-circle"></i> Отказана
                                                </span>
                                            }
                                            @if (reservation.ReservationStatus == "Pending")
                                            {
                                                <span style="font-size: 1em; color: orange;">
                                                    <i class="fas fa-circle"></i> Изчакване
                                                </span>
                                            }
                                        </td>
                                        @if (reservation.ReservationStatus == "Pending")
                                        {
                                            <td>
                                                <form asp-action="ChangeStatus"
                                                onclick="this.form.submit()" enctype="multipart/form-data">
                                                    <div class="form-group">
                                                        <select asp-for="@reservation.ReservationStatus" 
                                                        onchange="this.form.submit()" class="form-control">
                                                            <option value=""></option>
                                                            <option value="@ReservationStatus.Approved">Потвърди</option>
                                                            <option value="@ReservationStatus.Canceled">Откажи</option>
                                                        </select>
                                                    </div>
                                                    <div class="form-group">
                                                        <input type="hidden" asp-for="@reservation.Id">
                                                        <input type="hidden" asp-for="@reservation.RestaurantId">
                                                    </div>
                                                </form>
                                            </td>
                                        }


                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
            <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">
                ...

            </div>

        </div>
    </div>
</div>

